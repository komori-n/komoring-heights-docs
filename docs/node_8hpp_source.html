<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KomoringHeights: node.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KomoringHeights
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">node.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="node_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifndef KOMORI_NODE_HPP_</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#define KOMORI_NODE_HPP_</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;stack&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;../../mate/mate.h&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="board__key__hand__pair_8hpp.html">board_key_hand_pair.hpp</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="hands_8hpp.html">hands.hpp</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="path__keys_8hpp.html">path_keys.hpp</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="typedefs_8hpp.html">typedefs.hpp</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="visit__history_8hpp.html">visit_history.hpp</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacekomori.html">komori</a> {</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html">   37</a></span>&#160;<span class="keyword">class </span><a class="code" href="classkomori_1_1_node.html">Node</a> {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; <span class="keyword">public</span>:</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a3458bdb5c69b7e277d4ecd6801b93289">   46</a></span>&#160;  <span class="keyword">explicit</span> <a class="code" href="classkomori_1_1_node.html#a3458bdb5c69b7e277d4ecd6801b93289">Node</a>(Position&amp; n, <span class="keywordtype">bool</span> or_node, Key path_key = 0, Depth depth = 0)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      : <a class="code" href="classkomori_1_1_node.html#aada657f451395f6b47cc1af4af44e79c">n_</a>{std::ref(n)},</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">or_color_</a>{or_node ? n.side_to_move() : ~n.side_to_move()},</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>{depth},</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        <a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a>{path_key} {}</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a95368bcf74c80828738c57146cb72f78">   52</a></span>&#160;  <a class="code" href="classkomori_1_1_node.html#a95368bcf74c80828738c57146cb72f78">Node</a>() = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#afa0bb52e45fcf1cb4685fcebc99979cc">   54</a></span>&#160;  <a class="code" href="classkomori_1_1_node.html#afa0bb52e45fcf1cb4685fcebc99979cc">Node</a>(<span class="keyword">const</span> <a class="code" href="classkomori_1_1_node.html">Node</a>&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a6a449981c4047f846642145c398f4a31">   56</a></span>&#160;  <a class="code" href="classkomori_1_1_node.html#a6a449981c4047f846642145c398f4a31">Node</a>(<a class="code" href="classkomori_1_1_node.html">Node</a>&amp;&amp;) noexcept = default;</div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a24a874b0ba0435081c395aa40311f885">   58</a></span>&#160;  <a class="code" href="classkomori_1_1_node.html">Node</a>&amp; operator=(const <a class="code" href="classkomori_1_1_node.html">Node</a>&amp;) = delete;</div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ab21e5fded227691a2bdc851246b47110">   60</a></span>&#160;  <a class="code" href="classkomori_1_1_node.html">Node</a>&amp; operator=(<a class="code" href="classkomori_1_1_node.html">Node</a>&amp;&amp;) noexcept = default;</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a6584e52519e9c7309e026fcc7368c716">   62</a></span>&#160;  ~<a class="code" href="classkomori_1_1_node.html">Node</a>() = default;</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">   65</a></span>&#160;  Position&amp; <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>() { <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#aada657f451395f6b47cc1af4af44e79c">n_</a>.get(); }</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a1a3d31110bca8da2770321559bba42c4">   67</a></span>&#160;  <span class="keyword">const</span> Position&amp; <a class="code" href="classkomori_1_1_node.html#a1a3d31110bca8da2770321559bba42c4">Pos</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#aada657f451395f6b47cc1af4af44e79c">n_</a>.get(); }</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#acd0ed0838fa087e459aadae9cf563b0c">   70</a></span>&#160;  Color <a class="code" href="classkomori_1_1_node.html#acd0ed0838fa087e459aadae9cf563b0c">Us</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().side_to_move(); }</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#adaedff66091f29b80ddc19060c68471b">   72</a></span>&#160;  Color <a class="code" href="classkomori_1_1_node.html#adaedff66091f29b80ddc19060c68471b">OrColor</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">or_color_</a>; }</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#af2b9d2ba13ac5a9536d6aa1b618d2753">   74</a></span>&#160;  Color <a class="code" href="classkomori_1_1_node.html#af2b9d2ba13ac5a9536d6aa1b618d2753">AndColor</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ~<a class="code" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">or_color_</a>; }</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a4340f73789f45570ffe593fc9d0aafa9">   76</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classkomori_1_1_node.html#a4340f73789f45570ffe593fc9d0aafa9">IsOrNode</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#acd0ed0838fa087e459aadae9cf563b0c">Us</a>() == <a class="code" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">or_color_</a>; }</div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">   78</a></span>&#160;  Hand <a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().hand_of(<a class="code" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">or_color_</a>); }</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#aa5937f4e1ea7d06752752e1d7a015592">   80</a></span>&#160;  Hand <a class="code" href="classkomori_1_1_node.html#aa5937f4e1ea7d06752752e1d7a015592">AndHand</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().hand_of(~<a class="code" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">or_color_</a>); }</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ad8aec0a7fdeb5376090cd1e5c3a833a2">   82</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classkomori_1_1_node.html#ad8aec0a7fdeb5376090cd1e5c3a833a2">IsRootOrNode</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a4340f73789f45570ffe593fc9d0aafa9">IsOrNode</a>() ^ (<a class="code" href="classkomori_1_1_node.html#a19fbde5adf6e542e61f6c620df5b4d16">GetDepth</a>() % 2 == 1); }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a19fbde5adf6e542e61f6c620df5b4d16">   85</a></span>&#160;  Depth <a class="code" href="classkomori_1_1_node.html#a19fbde5adf6e542e61f6c620df5b4d16">GetDepth</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>; }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ad15ef5316cd3059c59b62e058e8d6347">   88</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#ad15ef5316cd3059c59b62e058e8d6347">GetKey</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().key(); }</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">   90</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().state()-&gt;board_key(); }</div>
<div class="line"><a name="l00092"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a4181d9d06d60b7f11701b8add6a2e69f">   92</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#a4181d9d06d60b7f11701b8add6a2e69f">GetPathKey</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a>; }</div>
<div class="line"><a name="l00094"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a1e4f1da48b69fb3356543b7cf37aab12">   94</a></span>&#160;  <a class="code" href="structkomori_1_1_board_key_hand_pair.html">BoardKeyHandPair</a> <a class="code" href="classkomori_1_1_node.html#a1e4f1da48b69fb3356543b7cf37aab12">GetBoardKeyHandPair</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> {<a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>(), <a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>()}; }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a72a3584f10f5669262d8264fcbd7acc5">   97</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#a72a3584f10f5669262d8264fcbd7acc5">KeyAfter</a>(Move move)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().key_after(move); }</div>
<div class="line"><a name="l00099"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ab47757b0ecd5c40af2b2246a17477a13">   99</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#ab47757b0ecd5c40af2b2246a17477a13">BoardKeyAfter</a>(Move move)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().board_key_after(move); }</div>
<div class="line"><a name="l00101"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a6dfeb2e63ce33d5b9043010cbb8428c3">  101</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#a6dfeb2e63ce33d5b9043010cbb8428c3">PathKeyAfter</a>(Move move)<span class="keyword"> const </span>{ <a class="code" href="namespacekomori.html#ae0ab7ef1101897b620e05208fc8975ee">return ::komori::PathKeyAfter</a>(<a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a>, move, <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>); }</div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d">  103</a></span>&#160;  Hand <a class="code" href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d">OrHandAfter</a>(Move move)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkomori_1_1_node.html#a4340f73789f45570ffe593fc9d0aafa9">IsOrNode</a>()) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="namespacekomori.html#ae5838f0a6fe258eb2bc0197498cd7358">AfterHand</a>(<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>(), move, <a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ae8e8fe23b128f7ae53c3878437828caa">  111</a></span>&#160;  <a class="code" href="structkomori_1_1_board_key_hand_pair.html">BoardKeyHandPair</a> <a class="code" href="classkomori_1_1_node.html#ae8e8fe23b128f7ae53c3878437828caa">BoardKeyHandPairAfter</a>(Move move)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> {<a class="code" href="classkomori_1_1_node.html#ab47757b0ecd5c40af2b2246a17477a13">BoardKeyAfter</a>(move), <a class="code" href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d">OrHandAfter</a>(move)}; }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a082d5d0045420c8978206fda2b518e17">  114</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkomori_1_1_node.html#a082d5d0045420c8978206fda2b518e17">DoMove</a>(Move move) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a> = <a class="code" href="classkomori_1_1_node.html#a6dfeb2e63ce33d5b9043010cbb8428c3">PathKeyAfter</a>(move);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a3ba89e53fbe90e03b07b2c68eea98334">Visit</a>(<a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>(), this-&gt;<a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>(), <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().do_move(move, <a class="code" href="classkomori_1_1_node.html#a0b57ad8775549ea2c419972659822ec0">st_info_</a>.emplace());</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>++;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#aad7fe2734b150a1d9645ea72e2fdda83">  122</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classkomori_1_1_node.html#aad7fe2734b150a1d9645ea72e2fdda83">UndoMove</a>() {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> last_move = <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().state()-&gt;lastMove;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>--;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().undo_move(last_move);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a0b57ad8775549ea2c419972659822ec0">st_info_</a>.pop();</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a3af0755f672c9b15c72253aebc682aa5">Leave</a>(<a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>(), this-&gt;<a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>(), <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a> = <a class="code" href="classkomori_1_1_node.html#a7f1c13d7f57b6af7f34ac77240342d71">PathKeyBefore</a>(last_move);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ab722a03251870c67b0414bffe79ac35b">  133</a></span>&#160;  [[deprecated]] <span class="keywordtype">void</span> <a class="code" href="classkomori_1_1_node.html#ab722a03251870c67b0414bffe79ac35b">StealCapturedPiece</a>() {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">auto</span> captured_pr = raw_type_of(<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().state()-&gt;capturedPiece);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a> = <a class="code" href="namespacekomori.html#a2cf6683308beb3ccfd868d347e93c8ac">PathKeyAfterSteal</a>(<a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a>, captured_pr, <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().steal_hand(captured_pr);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a601d86ce95c2bbe51b70e88652aed223">  140</a></span>&#160;  [[deprecated]] <span class="keywordtype">void</span> <a class="code" href="classkomori_1_1_node.html#a601d86ce95c2bbe51b70e88652aed223">UnstealCapturedPiece</a>() {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keyword">auto</span> captured_pr = raw_type_of(<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().state()-&gt;capturedPiece);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a> = <a class="code" href="namespacekomori.html#a0f2d9c64c7921e22678f953901421109">PathKeyAfterGive</a>(<a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a>, captured_pr, <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().give_hand(captured_pr);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a70a1bdd7ca7f930994fccccf52a4a26b">  147</a></span>&#160;  [[deprecated]] Move <a class="code" href="classkomori_1_1_node.html#a70a1bdd7ca7f930994fccccf52a4a26b">ImmediateCapture</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classkomori_1_1_node.html#a4340f73789f45570ffe593fc9d0aafa9">IsOrNode</a>() || <a class="code" href="classkomori_1_1_node.html#a19fbde5adf6e542e61f6c620df5b4d16">GetDepth</a>() &lt; 1) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">return</span> MOVE_NONE;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">// 両王手のときは少しだけ注意が必要。以下のコードで問題ない</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// - 近接王手駒がchecker_sq: between_bb の結果が空なので次の if 文の中に入る</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="comment">// - 遠隔王手駒がchecker_sq: between_bb へ駒を打ったり移動したりする手は王手回避にならない。</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="comment">//   つまり、必ず次の if 文の中に入る</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keyword">auto</span> last_move = <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().state()-&gt;lastMove;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">auto</span> checker_sq = <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().state()-&gt;previous-&gt;checkersBB.pop_c();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">auto</span> king_sq = <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().king_square(~<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().side_to_move());</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="keyword">auto</span> between = between_bb(king_sq, checker_sq);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span> (!between.test(to_sq(last_move))) {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="keywordflow">return</span> MOVE_NONE;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">auto</span> checker = <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().piece_on(checker_sq);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keyword">auto</span> capture_move = make_move(checker_sq, to_sq(last_move), checker);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().pseudo_legal(capture_move) &amp;&amp; <a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().legal(capture_move)) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <span class="keywordflow">return</span> capture_move;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keywordflow">return</span> MOVE_NONE;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a45d29905697f05269fc87033c0012d6f">  175</a></span>&#160;  std::optional&lt;Depth&gt; <a class="code" href="classkomori_1_1_node.html#a45d29905697f05269fc87033c0012d6f">IsRepetition</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a5b2e24143732a4396cc526be6aac0196">Contains</a>(<a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>(), this-&gt;<a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>()); }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a08df83d26ea813034372bd2bf08174c8">  178</a></span>&#160;  std::optional&lt;Depth&gt; <a class="code" href="classkomori_1_1_node.html#a08df83d26ea813034372bd2bf08174c8">IsRepetitionAfter</a>(Move move)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a5b2e24143732a4396cc526be6aac0196">Contains</a>(<a class="code" href="classkomori_1_1_node.html#ab47757b0ecd5c40af2b2246a17477a13">BoardKeyAfter</a>(move), this-&gt;<a class="code" href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d">OrHandAfter</a>(move));</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  }</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ad0c0ac41c51b49479bb8ff4a7716b5f6">  183</a></span>&#160;  std::optional&lt;Depth&gt; <a class="code" href="classkomori_1_1_node.html#ad0c0ac41c51b49479bb8ff4a7716b5f6">IsRepetitionOrInferior</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a2ff15618b56e74ace00b9b57434fec4f">IsInferior</a>(<a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>(), this-&gt;<a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>()); }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a38f310d0efd41fc2f4c376fdf44c7210">  186</a></span>&#160;  std::optional&lt;Depth&gt; <a class="code" href="classkomori_1_1_node.html#a38f310d0efd41fc2f4c376fdf44c7210">IsRepetitionOrInferiorAfter</a>(Move move)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a2ff15618b56e74ace00b9b57434fec4f">IsInferior</a>(<a class="code" href="classkomori_1_1_node.html#ab47757b0ecd5c40af2b2246a17477a13">BoardKeyAfter</a>(move), this-&gt;<a class="code" href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d">OrHandAfter</a>(move));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a7f981c15e9dcf84509bf75d3feb12344">  191</a></span>&#160;  std::optional&lt;Depth&gt; <a class="code" href="classkomori_1_1_node.html#a7f981c15e9dcf84509bf75d3feb12344">IsRepetitionOrSuperior</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a5de3895ada4a6c8d7cab0e0f8261e429">IsSuperior</a>(<a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>(), this-&gt;<a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>()); }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#aa68a5545707d7b8f44b28757423ab32d">  194</a></span>&#160;  std::optional&lt;Depth&gt; <a class="code" href="classkomori_1_1_node.html#aa68a5545707d7b8f44b28757423ab32d">IsRepetitionOrSuperiorAfter</a>(Move move)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a5de3895ada4a6c8d7cab0e0f8261e429">IsSuperior</a>(<a class="code" href="classkomori_1_1_node.html#ab47757b0ecd5c40af2b2246a17477a13">BoardKeyAfter</a>(move), this-&gt;<a class="code" href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d">OrHandAfter</a>(move));</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a518389ecf55b16ebf8f41dcb8c5ff731">  199</a></span>&#160;  std::optional&lt;Depth&gt; <a class="code" href="classkomori_1_1_node.html#a518389ecf55b16ebf8f41dcb8c5ff731">ContainsInPath</a>(Key board_key, Hand hand)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">const</span> <span class="keyword">auto</span> opt = <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>.<a class="code" href="classkomori_1_1_visit_history.html#a5b2e24143732a4396cc526be6aac0196">Contains</a>(board_key, hand)) {</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">return</span> opt;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">BoardKey</a>() == board_key &amp;&amp; <a class="code" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">OrHand</a>() == hand) {</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordflow">return</span> std::nullopt;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160; <span class="keyword">private</span>:</div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a7f1c13d7f57b6af7f34ac77240342d71">  212</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#a7f1c13d7f57b6af7f34ac77240342d71">PathKeyBefore</a>(Move move)<span class="keyword"> const </span>{ <a class="code" href="namespacekomori.html#af65c288516ec71f448f2947aac9e755b">return ::komori::PathKeyBefore</a>(<a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a>, move, <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>); }</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#aada657f451395f6b47cc1af4af44e79c">  215</a></span>&#160;  std::reference_wrapper&lt;Position&gt; <a class="code" href="classkomori_1_1_node.html#aada657f451395f6b47cc1af4af44e79c">n_</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">  216</a></span>&#160;  Color <a class="code" href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">or_color_</a>;                   </div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">  217</a></span>&#160;  Depth <a class="code" href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">depth_</a>{};                    </div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">  218</a></span>&#160;  <a class="code" href="classkomori_1_1_visit_history.html">VisitHistory</a> <a class="code" href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">visit_history_</a>{};     </div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a0b57ad8775549ea2c419972659822ec0">  219</a></span>&#160;  std::stack&lt;StateInfo&gt; <a class="code" href="classkomori_1_1_node.html#a0b57ad8775549ea2c419972659822ec0">st_info_</a>{};  </div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="line" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">  220</a></span>&#160;  Key <a class="code" href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">path_key_</a>{};                   </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;};</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="line" href="namespacekomori.html#adb4a7bc8f5922f5024476b6d276e0169">  224</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacekomori.html#adb4a7bc8f5922f5024476b6d276e0169">RollForward</a>(<a class="code" href="classkomori_1_1_node.html">Node</a>&amp; n, <span class="keyword">const</span> std::vector&lt;Move&gt;&amp; moves) {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; move : moves) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    n.<a class="code" href="classkomori_1_1_node.html#a082d5d0045420c8978206fda2b518e17">DoMove</a>(move);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;}</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="namespacekomori.html#a13b1a743c345f921833c153fd537a50d">  231</a></span>&#160;<span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="namespacekomori.html#a13b1a743c345f921833c153fd537a50d">RollBack</a>(<a class="code" href="classkomori_1_1_node.html">Node</a>&amp; n, <span class="keyword">const</span> std::vector&lt;Move&gt;&amp; moves) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> itr = moves.crbegin(); itr != moves.crend(); ++itr) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    n.<a class="code" href="classkomori_1_1_node.html#aad7fe2734b150a1d9645ea72e2fdda83">UndoMove</a>();</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="line" href="namespacekomori.html#af60b97ffafc4e100347e046e86ef02ac">  244</a></span>&#160;<span class="keyword">inline</span> std::pair&lt;Move, Hand&gt; <a class="code" href="namespacekomori.html#af60b97ffafc4e100347e046e86ef02ac">CheckMate1Ply</a>(<a class="code" href="classkomori_1_1_node.html">Node</a>&amp; n) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <span class="keywordflow">if</span> (!n.<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>().in_check()) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordflow">if</span> (<span class="keyword">auto</span> move = Mate::mate_1ply(n.<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>()); move != MOVE_NONE) {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      n.<a class="code" href="classkomori_1_1_node.html#a082d5d0045420c8978206fda2b518e17">DoMove</a>(move);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keyword">auto</span> hand = <a class="code" href="classkomori_1_1_hand_set.html">HandSet</a>{<a class="code" href="structkomori_1_1_proof_hand_tag.html">ProofHandTag</a>{}}.Get(n.<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      n.<a class="code" href="classkomori_1_1_node.html#aad7fe2734b150a1d9645ea72e2fdda83">UndoMove</a>();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      <span class="keywordflow">return</span> {move, <a class="code" href="namespacekomori.html#ace83f8e2ffff818bd25b6def2e075904">BeforeHand</a>(n.<a class="code" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">Pos</a>(), move, hand)};</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  }</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">return</span> {MOVE_NONE, <a class="code" href="namespacekomori.html#a210e0bb519f465c1516790e741bda731">kNullHand</a>};</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;}  <span class="comment">// namespace komori</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#endif  </span><span class="comment">// KOMORI_NODE_HPP_</span></div>
<div class="ttc" id="aboard__key__hand__pair_8hpp_html"><div class="ttname"><a href="board__key__hand__pair_8hpp.html">board_key_hand_pair.hpp</a></div></div>
<div class="ttc" id="aclasskomori_1_1_hand_set_html"><div class="ttname"><a href="classkomori_1_1_hand_set.html">komori::HandSet</a></div><div class="ttdoc">子局面の証明駒 or 反証駒をもとに、現局面の証明駒 or 反証駒を求めるクラス。</div><div class="ttdef"><b>Definition:</b> <a href="hands_8hpp_source.html#l00256">hands.hpp:256</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html"><div class="ttname"><a href="classkomori_1_1_node.html">komori::Node</a></div><div class="ttdoc">Position をラップして詰将棋特有の判定を追加するクラス。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00037">node.hpp:37</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a082d5d0045420c8978206fda2b518e17"><div class="ttname"><a href="classkomori_1_1_node.html#a082d5d0045420c8978206fda2b518e17">komori::Node::DoMove</a></div><div class="ttdeci">void DoMove(Move move)</div><div class="ttdoc">move で1手進める</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00114">node.hpp:114</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a08df83d26ea813034372bd2bf08174c8"><div class="ttname"><a href="classkomori_1_1_node.html#a08df83d26ea813034372bd2bf08174c8">komori::Node::IsRepetitionAfter</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsRepetitionAfter(Move move) const</div><div class="ttdoc">move をすると千日手になるかどうか</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00178">node.hpp:178</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a0b57ad8775549ea2c419972659822ec0"><div class="ttname"><a href="classkomori_1_1_node.html#a0b57ad8775549ea2c419972659822ec0">komori::Node::st_info_</a></div><div class="ttdeci">std::stack&lt; StateInfo &gt; st_info_</div><div class="ttdoc">do_move で必要な一時領域</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00219">node.hpp:219</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a19fbde5adf6e542e61f6c620df5b4d16"><div class="ttname"><a href="classkomori_1_1_node.html#a19fbde5adf6e542e61f6c620df5b4d16">komori::Node::GetDepth</a></div><div class="ttdeci">Depth GetDepth() const</div><div class="ttdoc">現在の探索深さ</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00085">node.hpp:85</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a1a3d31110bca8da2770321559bba42c4"><div class="ttname"><a href="classkomori_1_1_node.html#a1a3d31110bca8da2770321559bba42c4">komori::Node::Pos</a></div><div class="ttdeci">const Position &amp; Pos() const</div><div class="ttdoc">このクラスが保持する Position への参照</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00067">node.hpp:67</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a1e4f1da48b69fb3356543b7cf37aab12"><div class="ttname"><a href="classkomori_1_1_node.html#a1e4f1da48b69fb3356543b7cf37aab12">komori::Node::GetBoardKeyHandPair</a></div><div class="ttdeci">BoardKeyHandPair GetBoardKeyHandPair() const</div><div class="ttdoc">盤面ハッシュ値と攻め方の持ち駒を同時に取得する</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00094">node.hpp:94</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a2c10b9d22f4966f51b47495088f4fd4b"><div class="ttname"><a href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b">komori::Node::OrHand</a></div><div class="ttdeci">Hand OrHand() const</div><div class="ttdoc">現在の攻め方の持ち駒</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00078">node.hpp:78</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a3458bdb5c69b7e277d4ecd6801b93289"><div class="ttname"><a href="classkomori_1_1_node.html#a3458bdb5c69b7e277d4ecd6801b93289">komori::Node::Node</a></div><div class="ttdeci">Node(Position &amp;n, bool or_node, Key path_key=0, Depth depth=0)</div><div class="ttdoc">コンストラクタ</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00046">node.hpp:46</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a38f310d0efd41fc2f4c376fdf44c7210"><div class="ttname"><a href="classkomori_1_1_node.html#a38f310d0efd41fc2f4c376fdf44c7210">komori::Node::IsRepetitionOrInferiorAfter</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsRepetitionOrInferiorAfter(Move move) const</div><div class="ttdoc">move をすると千日手または劣等局面になるかどうか</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00186">node.hpp:186</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a4181d9d06d60b7f11701b8add6a2e69f"><div class="ttname"><a href="classkomori_1_1_node.html#a4181d9d06d60b7f11701b8add6a2e69f">komori::Node::GetPathKey</a></div><div class="ttdeci">Key GetPathKey() const</div><div class="ttdoc">現在の経路ハッシュ値</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00092">node.hpp:92</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a4340f73789f45570ffe593fc9d0aafa9"><div class="ttname"><a href="classkomori_1_1_node.html#a4340f73789f45570ffe593fc9d0aafa9">komori::Node::IsOrNode</a></div><div class="ttdeci">bool IsOrNode() const</div><div class="ttdoc">現在 OR node かどうか</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00076">node.hpp:76</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a440c0cf5ca77f86bb8dd289882bdb1fb"><div class="ttname"><a href="classkomori_1_1_node.html#a440c0cf5ca77f86bb8dd289882bdb1fb">komori::Node::or_color_</a></div><div class="ttdeci">Color or_color_</div><div class="ttdoc">OR node（攻め方）の手番</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00216">node.hpp:216</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a45d29905697f05269fc87033c0012d6f"><div class="ttname"><a href="classkomori_1_1_node.html#a45d29905697f05269fc87033c0012d6f">komori::Node::IsRepetition</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsRepetition() const</div><div class="ttdoc">現局面が千日手かどうか</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00175">node.hpp:175</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a485678f91b4653d87fcf5ee6071351de"><div class="ttname"><a href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de">komori::Node::Pos</a></div><div class="ttdeci">Position &amp; Pos()</div><div class="ttdoc">このクラスが保持する Position への参照</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00065">node.hpp:65</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a518389ecf55b16ebf8f41dcb8c5ff731"><div class="ttname"><a href="classkomori_1_1_node.html#a518389ecf55b16ebf8f41dcb8c5ff731">komori::Node::ContainsInPath</a></div><div class="ttdeci">std::optional&lt; Depth &gt; ContainsInPath(Key board_key, Hand hand) const</div><div class="ttdoc">(board_key, hand) が経路に含まれているかどうか</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00199">node.hpp:199</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a601d86ce95c2bbe51b70e88652aed223"><div class="ttname"><a href="classkomori_1_1_node.html#a601d86ce95c2bbe51b70e88652aed223">komori::Node::UnstealCapturedPiece</a></div><div class="ttdeci">void UnstealCapturedPiece()</div><div class="ttdoc">(not maintained) StealCapturedPiece() で奪った駒を返す</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00140">node.hpp:140</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a6a449981c4047f846642145c398f4a31"><div class="ttname"><a href="classkomori_1_1_node.html#a6a449981c4047f846642145c398f4a31">komori::Node::Node</a></div><div class="ttdeci">Node(Node &amp;&amp;) noexcept=default</div><div class="ttdoc">Move constructor(default)</div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a6dfeb2e63ce33d5b9043010cbb8428c3"><div class="ttname"><a href="classkomori_1_1_node.html#a6dfeb2e63ce33d5b9043010cbb8428c3">komori::Node::PathKeyAfter</a></div><div class="ttdeci">Key PathKeyAfter(Move move) const</div><div class="ttdoc">move 後の経路ハッシュ値</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00101">node.hpp:101</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a70a1bdd7ca7f930994fccccf52a4a26b"><div class="ttname"><a href="classkomori_1_1_node.html#a70a1bdd7ca7f930994fccccf52a4a26b">komori::Node::ImmediateCapture</a></div><div class="ttdeci">Move ImmediateCapture() const</div><div class="ttdoc">(not maintained) 直前の王手駒をすぐに取り返す手を生成する。もしできなければ MOVE_NONE を返す。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00147">node.hpp:147</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a72a3584f10f5669262d8264fcbd7acc5"><div class="ttname"><a href="classkomori_1_1_node.html#a72a3584f10f5669262d8264fcbd7acc5">komori::Node::KeyAfter</a></div><div class="ttdeci">Key KeyAfter(Move move) const</div><div class="ttdoc">move 後のハッシュ値</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00097">node.hpp:97</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a7f1c13d7f57b6af7f34ac77240342d71"><div class="ttname"><a href="classkomori_1_1_node.html#a7f1c13d7f57b6af7f34ac77240342d71">komori::Node::PathKeyBefore</a></div><div class="ttdeci">Key PathKeyBefore(Move move) const</div><div class="ttdoc">move 直前の経路ハッシュ値</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00212">node.hpp:212</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a7f981c15e9dcf84509bf75d3feb12344"><div class="ttname"><a href="classkomori_1_1_node.html#a7f981c15e9dcf84509bf75d3feb12344">komori::Node::IsRepetitionOrSuperior</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsRepetitionOrSuperior() const</div><div class="ttdoc">現局面が千日手または優等局面か</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00191">node.hpp:191</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a921bc5091e9b50d471336c92b29ee64a"><div class="ttname"><a href="classkomori_1_1_node.html#a921bc5091e9b50d471336c92b29ee64a">komori::Node::path_key_</a></div><div class="ttdeci">Key path_key_</div><div class="ttdoc">経路ハッシュ値。差分計算により求める。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00220">node.hpp:220</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_a95368bcf74c80828738c57146cb72f78"><div class="ttname"><a href="classkomori_1_1_node.html#a95368bcf74c80828738c57146cb72f78">komori::Node::Node</a></div><div class="ttdeci">Node()=delete</div><div class="ttdoc">Default constructor(delete)</div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_aa5937f4e1ea7d06752752e1d7a015592"><div class="ttname"><a href="classkomori_1_1_node.html#aa5937f4e1ea7d06752752e1d7a015592">komori::Node::AndHand</a></div><div class="ttdeci">Hand AndHand() const</div><div class="ttdoc">現在の玉方の持ち駒</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00080">node.hpp:80</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_aa68a5545707d7b8f44b28757423ab32d"><div class="ttname"><a href="classkomori_1_1_node.html#aa68a5545707d7b8f44b28757423ab32d">komori::Node::IsRepetitionOrSuperiorAfter</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsRepetitionOrSuperiorAfter(Move move) const</div><div class="ttdoc">move をすると千日手または優等局面になるかどうか</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00194">node.hpp:194</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_aad7fe2734b150a1d9645ea72e2fdda83"><div class="ttname"><a href="classkomori_1_1_node.html#aad7fe2734b150a1d9645ea72e2fdda83">komori::Node::UndoMove</a></div><div class="ttdeci">void UndoMove()</div><div class="ttdoc">DoMove() で勧めた局面を元に戻す</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00122">node.hpp:122</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_aada657f451395f6b47cc1af4af44e79c"><div class="ttname"><a href="classkomori_1_1_node.html#aada657f451395f6b47cc1af4af44e79c">komori::Node::n_</a></div><div class="ttdeci">std::reference_wrapper&lt; Position &gt; n_</div><div class="ttdoc">現在の局面。move construct 可能にするために生参照ではなく std::reference_wrapper で持つ。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00215">node.hpp:215</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ab47757b0ecd5c40af2b2246a17477a13"><div class="ttname"><a href="classkomori_1_1_node.html#ab47757b0ecd5c40af2b2246a17477a13">komori::Node::BoardKeyAfter</a></div><div class="ttdeci">Key BoardKeyAfter(Move move) const</div><div class="ttdoc">move 後の盤面ハッシュ値</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00099">node.hpp:99</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ab4cef9789a5033be7e6d15affd2ebab4"><div class="ttname"><a href="classkomori_1_1_node.html#ab4cef9789a5033be7e6d15affd2ebab4">komori::Node::depth_</a></div><div class="ttdeci">Depth depth_</div><div class="ttdoc">root から数えた探索深さ</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00217">node.hpp:217</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ab722a03251870c67b0414bffe79ac35b"><div class="ttname"><a href="classkomori_1_1_node.html#ab722a03251870c67b0414bffe79ac35b">komori::Node::StealCapturedPiece</a></div><div class="ttdeci">void StealCapturedPiece()</div><div class="ttdoc">(not maintained) 直前に相手が取った駒を奪う。UnstealCapturedPiece() をするまでは UndoMove() してはいけない。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00133">node.hpp:133</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ac82d1552c36647cc88e62b104b77595d"><div class="ttname"><a href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d">komori::Node::OrHandAfter</a></div><div class="ttdeci">Hand OrHandAfter(Move move) const</div><div class="ttdoc">move 後の攻め方の持ち駒</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00103">node.hpp:103</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_acd0ed0838fa087e459aadae9cf563b0c"><div class="ttname"><a href="classkomori_1_1_node.html#acd0ed0838fa087e459aadae9cf563b0c">komori::Node::Us</a></div><div class="ttdeci">Color Us() const</div><div class="ttdoc">現在の手番</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00070">node.hpp:70</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ad0c0ac41c51b49479bb8ff4a7716b5f6"><div class="ttname"><a href="classkomori_1_1_node.html#ad0c0ac41c51b49479bb8ff4a7716b5f6">komori::Node::IsRepetitionOrInferior</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsRepetitionOrInferior() const</div><div class="ttdoc">現局面が千日手または劣等局面か</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00183">node.hpp:183</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ad15ef5316cd3059c59b62e058e8d6347"><div class="ttname"><a href="classkomori_1_1_node.html#ad15ef5316cd3059c59b62e058e8d6347">komori::Node::GetKey</a></div><div class="ttdeci">Key GetKey() const</div><div class="ttdoc">現在のハッシュ値</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00088">node.hpp:88</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ad8aec0a7fdeb5376090cd1e5c3a833a2"><div class="ttname"><a href="classkomori_1_1_node.html#ad8aec0a7fdeb5376090cd1e5c3a833a2">komori::Node::IsRootOrNode</a></div><div class="ttdeci">bool IsRootOrNode() const</div><div class="ttdoc">開始局面が OR Node かどうか</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00082">node.hpp:82</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_adaedff66091f29b80ddc19060c68471b"><div class="ttname"><a href="classkomori_1_1_node.html#adaedff66091f29b80ddc19060c68471b">komori::Node::OrColor</a></div><div class="ttdeci">Color OrColor() const</div><div class="ttdoc">OR node（攻め方）の手番</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00072">node.hpp:72</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_adc2ad58f3df2a1789f14a969d0678df3"><div class="ttname"><a href="classkomori_1_1_node.html#adc2ad58f3df2a1789f14a969d0678df3">komori::Node::visit_history_</a></div><div class="ttdeci">VisitHistory visit_history_</div><div class="ttdoc">千日手・優等局面の一覧</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00218">node.hpp:218</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_ae8e8fe23b128f7ae53c3878437828caa"><div class="ttname"><a href="classkomori_1_1_node.html#ae8e8fe23b128f7ae53c3878437828caa">komori::Node::BoardKeyHandPairAfter</a></div><div class="ttdeci">BoardKeyHandPair BoardKeyHandPairAfter(Move move) const</div><div class="ttdoc">move 後の盤面ハッシュ値と攻め方の持ち駒を同時に取得する</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00111">node.hpp:111</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_af2b9d2ba13ac5a9536d6aa1b618d2753"><div class="ttname"><a href="classkomori_1_1_node.html#af2b9d2ba13ac5a9536d6aa1b618d2753">komori::Node::AndColor</a></div><div class="ttdeci">Color AndColor() const</div><div class="ttdoc">AND node（玉方）の手番</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00074">node.hpp:74</a></div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_afa0bb52e45fcf1cb4685fcebc99979cc"><div class="ttname"><a href="classkomori_1_1_node.html#afa0bb52e45fcf1cb4685fcebc99979cc">komori::Node::Node</a></div><div class="ttdeci">Node(const Node &amp;)=delete</div><div class="ttdoc">Copy constructor(delete)</div></div>
<div class="ttc" id="aclasskomori_1_1_node_html_afc3ff609d7a14aae03aab36317148f63"><div class="ttname"><a href="classkomori_1_1_node.html#afc3ff609d7a14aae03aab36317148f63">komori::Node::BoardKey</a></div><div class="ttdeci">Key BoardKey() const</div><div class="ttdoc">現在の盤面ハッシュ値</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00090">node.hpp:90</a></div></div>
<div class="ttc" id="aclasskomori_1_1_visit_history_html"><div class="ttname"><a href="classkomori_1_1_visit_history.html">komori::VisitHistory</a></div><div class="ttdoc">探索履歴を管理し、千日手や優等局面の判定を行うクラス。</div><div class="ttdef"><b>Definition:</b> <a href="visit__history_8hpp_source.html#l00022">visit_history.hpp:22</a></div></div>
<div class="ttc" id="aclasskomori_1_1_visit_history_html_a2ff15618b56e74ace00b9b57434fec4f"><div class="ttname"><a href="classkomori_1_1_visit_history.html#a2ff15618b56e74ace00b9b57434fec4f">komori::VisitHistory::IsInferior</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsInferior(Key board_key, Hand hand) const</div><div class="ttdoc">(board_key, hand) の優等局面が履歴に記録されているか調べる。</div><div class="ttdef"><b>Definition:</b> <a href="visit__history_8hpp_source.html#l00074">visit_history.hpp:74</a></div></div>
<div class="ttc" id="aclasskomori_1_1_visit_history_html_a3af0755f672c9b15c72253aebc682aa5"><div class="ttname"><a href="classkomori_1_1_visit_history.html#a3af0755f672c9b15c72253aebc682aa5">komori::VisitHistory::Leave</a></div><div class="ttdeci">void Leave(Key board_key, Hand hand, Depth)</div><div class="ttdoc">(board_key, hand) を履歴から消す</div><div class="ttdef"><b>Definition:</b> <a href="visit__history_8hpp_source.html#l00042">visit_history.hpp:42</a></div></div>
<div class="ttc" id="aclasskomori_1_1_visit_history_html_a3ba89e53fbe90e03b07b2c68eea98334"><div class="ttname"><a href="classkomori_1_1_visit_history.html#a3ba89e53fbe90e03b07b2c68eea98334">komori::VisitHistory::Visit</a></div><div class="ttdeci">void Visit(Key board_key, Hand hand, Depth depth)</div><div class="ttdoc">(board_key, hand) を履歴に登録する</div><div class="ttdef"><b>Definition:</b> <a href="visit__history_8hpp_source.html#l00032">visit_history.hpp:32</a></div></div>
<div class="ttc" id="aclasskomori_1_1_visit_history_html_a5b2e24143732a4396cc526be6aac0196"><div class="ttname"><a href="classkomori_1_1_visit_history.html#a5b2e24143732a4396cc526be6aac0196">komori::VisitHistory::Contains</a></div><div class="ttdeci">std::optional&lt; Depth &gt; Contains(Key board_key, Hand hand) const</div><div class="ttdoc">(board_key, hand) の同一局面が履歴に記録されているか調べる。</div><div class="ttdef"><b>Definition:</b> <a href="visit__history_8hpp_source.html#l00057">visit_history.hpp:57</a></div></div>
<div class="ttc" id="aclasskomori_1_1_visit_history_html_a5de3895ada4a6c8d7cab0e0f8261e429"><div class="ttname"><a href="classkomori_1_1_visit_history.html#a5de3895ada4a6c8d7cab0e0f8261e429">komori::VisitHistory::IsSuperior</a></div><div class="ttdeci">std::optional&lt; Depth &gt; IsSuperior(Key board_key, Hand hand) const</div><div class="ttdoc">(board_key, hand) の劣等局面が履歴に記録されているか調べる。</div><div class="ttdef"><b>Definition:</b> <a href="visit__history_8hpp_source.html#l00091">visit_history.hpp:91</a></div></div>
<div class="ttc" id="ahands_8hpp_html"><div class="ttname"><a href="hands_8hpp.html">hands.hpp</a></div></div>
<div class="ttc" id="anamespacekomori_html"><div class="ttname"><a href="namespacekomori.html">komori</a></div><div class="ttdoc">Komoring Heights.</div><div class="ttdef"><b>Definition:</b> <a href="bitset_8hpp_source.html#l00015">bitset.hpp:15</a></div></div>
<div class="ttc" id="anamespacekomori_html_a0f2d9c64c7921e22678f953901421109"><div class="ttname"><a href="namespacekomori.html#a0f2d9c64c7921e22678f953901421109">komori::PathKeyAfterGive</a></div><div class="ttdeci">Key PathKeyAfterGive(Key path_key, PieceType given_pr, Depth depth)</div><div class="ttdoc">相手に持ち駒 stolen_pr を1枚プレゼントした後の path_key を計算する。</div><div class="ttdef"><b>Definition:</b> <a href="path__keys_8hpp_source.html#l00121">path_keys.hpp:121</a></div></div>
<div class="ttc" id="anamespacekomori_html_a13b1a743c345f921833c153fd537a50d"><div class="ttname"><a href="namespacekomori.html#a13b1a743c345f921833c153fd537a50d">komori::RollBack</a></div><div class="ttdeci">void RollBack(Node &amp;n, const std::vector&lt; Move &gt; &amp;moves)</div><div class="ttdoc">局面 n から moves で手を一気に戻す。n に対し、moves の後ろから順に n.UndoMove(m) を適用する。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00231">node.hpp:231</a></div></div>
<div class="ttc" id="anamespacekomori_html_a210e0bb519f465c1516790e741bda731"><div class="ttname"><a href="namespacekomori.html#a210e0bb519f465c1516790e741bda731">komori::kNullHand</a></div><div class="ttdeci">constexpr Hand kNullHand</div><div class="ttdoc">無効な持ち駒</div><div class="ttdef"><b>Definition:</b> <a href="typedefs_8hpp_source.html#l00174">typedefs.hpp:174</a></div></div>
<div class="ttc" id="anamespacekomori_html_a2cf6683308beb3ccfd868d347e93c8ac"><div class="ttname"><a href="namespacekomori.html#a2cf6683308beb3ccfd868d347e93c8ac">komori::PathKeyAfterSteal</a></div><div class="ttdeci">Key PathKeyAfterSteal(Key path_key, PieceType stolen_pr, Depth depth)</div><div class="ttdoc">相手の持ち駒 stolen_pr を1枚奪った後の path_key を計算する。</div><div class="ttdef"><b>Definition:</b> <a href="path__keys_8hpp_source.html#l00108">path_keys.hpp:108</a></div></div>
<div class="ttc" id="anamespacekomori_html_ace83f8e2ffff818bd25b6def2e075904"><div class="ttname"><a href="namespacekomori.html#ace83f8e2ffff818bd25b6def2e075904">komori::BeforeHand</a></div><div class="ttdeci">Hand BeforeHand(const Position &amp;n, Move move, Hand after_hand)</div><div class="ttdoc">move 後の手駒が after_hand のとき、移動前の持ち駒を返す</div><div class="ttdef"><b>Definition:</b> <a href="hands_8hpp_source.html#l00057">hands.hpp:57</a></div></div>
<div class="ttc" id="anamespacekomori_html_adb4a7bc8f5922f5024476b6d276e0169"><div class="ttname"><a href="namespacekomori.html#adb4a7bc8f5922f5024476b6d276e0169">komori::RollForward</a></div><div class="ttdeci">void RollForward(Node &amp;n, const std::vector&lt; Move &gt; &amp;moves)</div><div class="ttdoc">局面 n から moves で手を一気に進める。nに対し、moves の前から順に n.DoMove(m) を適用する。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00224">node.hpp:224</a></div></div>
<div class="ttc" id="anamespacekomori_html_ae0ab7ef1101897b620e05208fc8975ee"><div class="ttname"><a href="namespacekomori.html#ae0ab7ef1101897b620e05208fc8975ee">komori::PathKeyAfter</a></div><div class="ttdeci">Key PathKeyAfter(Key path_key, Move move, Depth depth)</div><div class="ttdoc">現在の path_key と手 move から1手後の path_key を計算する。</div><div class="ttdef"><b>Definition:</b> <a href="path__keys_8hpp_source.html#l00066">path_keys.hpp:66</a></div></div>
<div class="ttc" id="anamespacekomori_html_ae5838f0a6fe258eb2bc0197498cd7358"><div class="ttname"><a href="namespacekomori.html#ae5838f0a6fe258eb2bc0197498cd7358">komori::AfterHand</a></div><div class="ttdeci">Hand AfterHand(const Position &amp;n, Move move, Hand before_hand)</div><div class="ttdoc">move 後の手駒を返す</div><div class="ttdef"><b>Definition:</b> <a href="hands_8hpp_source.html#l00038">hands.hpp:38</a></div></div>
<div class="ttc" id="anamespacekomori_html_af60b97ffafc4e100347e046e86ef02ac"><div class="ttname"><a href="namespacekomori.html#af60b97ffafc4e100347e046e86ef02ac">komori::CheckMate1Ply</a></div><div class="ttdeci">std::pair&lt; Move, Hand &gt; CheckMate1Ply(Node &amp;n)</div><div class="ttdoc">(OR node限定) n が 1 手詰かどうか判定する。</div><div class="ttdef"><b>Definition:</b> <a href="node_8hpp_source.html#l00244">node.hpp:244</a></div></div>
<div class="ttc" id="anamespacekomori_html_af65c288516ec71f448f2947aac9e755b"><div class="ttname"><a href="namespacekomori.html#af65c288516ec71f448f2947aac9e755b">komori::PathKeyBefore</a></div><div class="ttdeci">Key PathKeyBefore(Key path_key, Move move, Depth depth)</div><div class="ttdoc">1手後の path_key と手 move から現在の path_key を計算する。</div><div class="ttdef"><b>Definition:</b> <a href="path__keys_8hpp_source.html#l00097">path_keys.hpp:97</a></div></div>
<div class="ttc" id="apath__keys_8hpp_html"><div class="ttname"><a href="path__keys_8hpp.html">path_keys.hpp</a></div></div>
<div class="ttc" id="astructkomori_1_1_board_key_hand_pair_html"><div class="ttname"><a href="structkomori_1_1_board_key_hand_pair.html">komori::BoardKeyHandPair</a></div><div class="ttdoc">盤面ハッシュ値と攻め方の持ち駒のペア。これがあれば TT から結果を取得できる。</div><div class="ttdef"><b>Definition:</b> <a href="board__key__hand__pair_8hpp_source.html#l00017">board_key_hand_pair.hpp:17</a></div></div>
<div class="ttc" id="astructkomori_1_1_proof_hand_tag_html"><div class="ttname"><a href="structkomori_1_1_proof_hand_tag.html">komori::ProofHandTag</a></div><div class="ttdoc">HandSet の初期化時に使うタグ（AND nodeの証明駒）</div><div class="ttdef"><b>Definition:</b> <a href="hands_8hpp_source.html#l00231">hands.hpp:231</a></div></div>
<div class="ttc" id="atypedefs_8hpp_html"><div class="ttname"><a href="typedefs_8hpp.html">typedefs.hpp</a></div></div>
<div class="ttc" id="avisit__history_8hpp_html"><div class="ttname"><a href="visit__history_8hpp.html">visit_history.hpp</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
