<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KomoringHeights: komori::tt::detail::TranspositionTableImpl&lt; Query, RegularTable, RepetitionTable &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KomoringHeights
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacekomori.html">komori</a></li><li class="navelem"><a class="el" href="namespacekomori_1_1tt.html">tt</a></li><li class="navelem"><a class="el" href="namespacekomori_1_1tt_1_1detail.html">detail</a></li><li class="navelem"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">TranspositionTableImpl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">komori::tt::detail::TranspositionTableImpl&lt; Query, RegularTable, RepetitionTable &gt; Class Template Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>詰将棋エンジンの置換表本体  
 <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for komori::tt::detail::TranspositionTableImpl&lt; Query, RegularTable, RepetitionTable &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl__coll__graph.png" border="0" usemap="#akomori_1_1tt_1_1detail_1_1_transposition_table_impl_3_01_query_00_01_regular_table_00_01_repetition_table_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="akomori_1_1tt_1_1detail_1_1_transposition_table_impl_3_01_query_00_01_regular_table_00_01_repetition_table_01_4_coll__map" id="akomori_1_1tt_1_1detail_1_1_transposition_table_impl_3_01_query_00_01_regular_table_00_01_repetition_table_01_4_coll__map">
<area shape="rect" title="詰将棋エンジンの置換表本体" alt="" coords="110,95,289,165"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html" title="経路に依存しない探索結果を記録する置換表。（通常テーブル）" alt="" coords="5,5,183,32"/>
<area shape="rect" href="classkomori_1_1tt_1_1_repetition_table.html" title="千日手手順を記録する置換表" alt="" coords="207,5,402,32"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9976a9b06db61868af55f416c2317cac"><td class="memItemLeft" align="right" valign="top"><a id="a9976a9b06db61868af55f416c2317cac"></a>
constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a9976a9b06db61868af55f416c2317cac">TranspositionTableImpl</a> ()=default</td></tr>
<tr class="memdesc:a9976a9b06db61868af55f416c2317cac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor(default) <br /></td></tr>
<tr class="separator:a9976a9b06db61868af55f416c2317cac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c24d5dd7a200160900d4241696c9e1e"><td class="memItemLeft" align="right" valign="top"><a id="a0c24d5dd7a200160900d4241696c9e1e"></a>
constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a0c24d5dd7a200160900d4241696c9e1e">TranspositionTableImpl</a> (const <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">TranspositionTableImpl</a> &amp;)=delete</td></tr>
<tr class="memdesc:a0c24d5dd7a200160900d4241696c9e1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy constructor(delete) <br /></td></tr>
<tr class="separator:a0c24d5dd7a200160900d4241696c9e1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0472159b40306cf837a6ed5dc7dd3eb4"><td class="memItemLeft" align="right" valign="top"><a id="a0472159b40306cf837a6ed5dc7dd3eb4"></a>
constexpr&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a0472159b40306cf837a6ed5dc7dd3eb4">TranspositionTableImpl</a> (<a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">TranspositionTableImpl</a> &amp;&amp;) noexcept=delete</td></tr>
<tr class="memdesc:a0472159b40306cf837a6ed5dc7dd3eb4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move constructor(default) <br /></td></tr>
<tr class="separator:a0472159b40306cf837a6ed5dc7dd3eb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd58fa21a626dd2aec61507dc40830a2"><td class="memItemLeft" align="right" valign="top"><a id="acd58fa21a626dd2aec61507dc40830a2"></a>
constexpr <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">TranspositionTableImpl</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#acd58fa21a626dd2aec61507dc40830a2">operator=</a> (const <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">TranspositionTableImpl</a> &amp;)=delete</td></tr>
<tr class="memdesc:acd58fa21a626dd2aec61507dc40830a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy assign operator(delete) <br /></td></tr>
<tr class="separator:acd58fa21a626dd2aec61507dc40830a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a272a11c91dee79fc97c8f2ab4056465e"><td class="memItemLeft" align="right" valign="top"><a id="a272a11c91dee79fc97c8f2ab4056465e"></a>
constexpr <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">TranspositionTableImpl</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a272a11c91dee79fc97c8f2ab4056465e">operator=</a> (<a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">TranspositionTableImpl</a> &amp;&amp;) noexcept=delete</td></tr>
<tr class="memdesc:a272a11c91dee79fc97c8f2ab4056465e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move assign operator(default) <br /></td></tr>
<tr class="separator:a272a11c91dee79fc97c8f2ab4056465e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e574f79e8c418ac9e58b2a7a9f97ea9"><td class="memItemLeft" align="right" valign="top"><a id="a0e574f79e8c418ac9e58b2a7a9f97ea9"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a0e574f79e8c418ac9e58b2a7a9f97ea9">~TranspositionTableImpl</a> ()=default</td></tr>
<tr class="memdesc:a0e574f79e8c418ac9e58b2a7a9f97ea9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor(default) <br /></td></tr>
<tr class="separator:a0e574f79e8c418ac9e58b2a7a9f97ea9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a315463f0ac29c325849d661a15cdc167"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a315463f0ac29c325849d661a15cdc167">Resize</a> (std::uint64_t hash_size_mb)</td></tr>
<tr class="memdesc:a315463f0ac29c325849d661a15cdc167"><td class="mdescLeft">&#160;</td><td class="mdescRight">置換表サイズを <code>hash_size_mb</code> に変更し、書かれていた内容をすべて消去する。  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a315463f0ac29c325849d661a15cdc167">More...</a><br /></td></tr>
<tr class="separator:a315463f0ac29c325849d661a15cdc167"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ba9bb9c00c85a2475c98b256ab1051"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a60ba9bb9c00c85a2475c98b256ab1051">NewSearch</a> ()</td></tr>
<tr class="memdesc:a60ba9bb9c00c85a2475c98b256ab1051"><td class="mdescLeft">&#160;</td><td class="mdescRight">新しい探索を始める  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a60ba9bb9c00c85a2475c98b256ab1051">More...</a><br /></td></tr>
<tr class="separator:a60ba9bb9c00c85a2475c98b256ab1051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af55851a911e7918a6b97947855f2f325"><td class="memItemLeft" align="right" valign="top"><a id="af55851a911e7918a6b97947855f2f325"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#af55851a911e7918a6b97947855f2f325">Clear</a> ()</td></tr>
<tr class="memdesc:af55851a911e7918a6b97947855f2f325"><td class="mdescLeft">&#160;</td><td class="mdescRight">以前の探索結果をすべて消去する。 <br /></td></tr>
<tr class="separator:af55851a911e7918a6b97947855f2f325"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96c4e38870490176e0053914a17c908c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a96c4e38870490176e0053914a17c908c">BuildQuery</a> (const <a class="el" href="classkomori_1_1_node.html">Node</a> &amp;n)</td></tr>
<tr class="memdesc:a96c4e38870490176e0053914a17c908c"><td class="mdescLeft">&#160;</td><td class="mdescRight">局面 <code>n</code> のエントリを読み書きするためのクエリを返す  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a96c4e38870490176e0053914a17c908c">More...</a><br /></td></tr>
<tr class="separator:a96c4e38870490176e0053914a17c908c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0f0621bb26449fdf6d8c00a8600d7e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a2a0f0621bb26449fdf6d8c00a8600d7e">BuildChildQuery</a> (const <a class="el" href="classkomori_1_1_node.html">Node</a> &amp;n, Move move)</td></tr>
<tr class="memdesc:a2a0f0621bb26449fdf6d8c00a8600d7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">局面 <code>n</code> を <code>move</code> で 1 手進めたエントリを読み書きするためのクエリを返す  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a2a0f0621bb26449fdf6d8c00a8600d7e">More...</a><br /></td></tr>
<tr class="separator:a2a0f0621bb26449fdf6d8c00a8600d7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0d9e65f7b1603b063cd8d3c7252a797"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#ad0d9e65f7b1603b063cd8d3c7252a797">BuildQueryByKey</a> (<a class="el" href="structkomori_1_1_board_key_hand_pair.html">BoardKeyHandPair</a> key_hand_pair, Key path_key=<a class="el" href="namespacekomori.html#a69ee19c9520e168d882df693b6566a9b">kNullKey</a>)</td></tr>
<tr class="memdesc:ad0d9e65f7b1603b063cd8d3c7252a797"><td class="mdescLeft">&#160;</td><td class="mdescRight">生のハッシュ値からクエリを構築する  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#ad0d9e65f7b1603b063cd8d3c7252a797">More...</a><br /></td></tr>
<tr class="separator:ad0d9e65f7b1603b063cd8d3c7252a797"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4179ad57f2d4a73ece89f9c380a7751a"><td class="memItemLeft" align="right" valign="top">std::int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a4179ad57f2d4a73ece89f9c380a7751a">Hashfull</a> () const</td></tr>
<tr class="memdesc:a4179ad57f2d4a73ece89f9c380a7751a"><td class="mdescLeft">&#160;</td><td class="mdescRight">置換表使用率（千分率）を計算する  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a4179ad57f2d4a73ece89f9c380a7751a">More...</a><br /></td></tr>
<tr class="separator:a4179ad57f2d4a73ece89f9c380a7751a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03fe64f10c6759a3d546410a9a5dd97c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a03fe64f10c6759a3d546410a9a5dd97c">CollectGarbage</a> (double gc_removal_ratio)</td></tr>
<tr class="memdesc:a03fe64f10c6759a3d546410a9a5dd97c"><td class="mdescLeft">&#160;</td><td class="mdescRight">ガベージコレクションを実行する  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a03fe64f10c6759a3d546410a9a5dd97c">More...</a><br /></td></tr>
<tr class="separator:a03fe64f10c6759a3d546410a9a5dd97c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e58a8adc4d1f758e77aa32caa4b34ba"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a1e58a8adc4d1f758e77aa32caa4b34ba">Save</a> (std::ostream &amp;os)</td></tr>
<tr class="memdesc:a1e58a8adc4d1f758e77aa32caa4b34ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">置換表の中身をバイナリ出力ストリーム <code>os</code> へ出力する  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a1e58a8adc4d1f758e77aa32caa4b34ba">More...</a><br /></td></tr>
<tr class="separator:a1e58a8adc4d1f758e77aa32caa4b34ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38165a8d6b382f5b9454f51c717c90cd"><td class="memItemLeft" align="right" valign="top">std::istream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a38165a8d6b382f5b9454f51c717c90cd">Load</a> (std::istream &amp;is)</td></tr>
<tr class="memdesc:a38165a8d6b382f5b9454f51c717c90cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">バイナリ入力ストリーム <code>in</code> から置換表エントリを読み込む。  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a38165a8d6b382f5b9454f51c717c90cd">More...</a><br /></td></tr>
<tr class="separator:a38165a8d6b382f5b9454f51c717c90cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a153f8d7584e9c0cb08d8d3f6cf011cb3"><td class="memItemLeft" align="right" valign="top">std::uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a153f8d7584e9c0cb08d8d3f6cf011cb3">Capacity</a> () const noexcept</td></tr>
<tr class="memdesc:a153f8d7584e9c0cb08d8d3f6cf011cb3"><td class="mdescLeft">&#160;</td><td class="mdescRight">置換表に保存可能な要素数の概算値を取得する。  <a href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a153f8d7584e9c0cb08d8d3f6cf011cb3">More...</a><br /></td></tr>
<tr class="separator:a153f8d7584e9c0cb08d8d3f6cf011cb3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8deb6c61bc1c4defdd94beff438e9f03"><td class="memItemLeft" align="right" valign="top"><a id="a8deb6c61bc1c4defdd94beff438e9f03"></a>
auto &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a8deb6c61bc1c4defdd94beff438e9f03">GetRegularTable</a> ()</td></tr>
<tr class="memdesc:a8deb6c61bc1c4defdd94beff438e9f03"><td class="mdescLeft">&#160;</td><td class="mdescRight">通常テーブルを直接取得する <br /></td></tr>
<tr class="separator:a8deb6c61bc1c4defdd94beff438e9f03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc4f6374ace54d567f639223993fb8f"><td class="memItemLeft" align="right" valign="top"><a id="acdc4f6374ace54d567f639223993fb8f"></a>
auto &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#acdc4f6374ace54d567f639223993fb8f">GetRepetitionTable</a> ()</td></tr>
<tr class="memdesc:acdc4f6374ace54d567f639223993fb8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">千日手テーブルを直接取得する <br /></td></tr>
<tr class="separator:acdc4f6374ace54d567f639223993fb8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a411d029edda10ba1cd8f232990d261e9"><td class="memItemLeft" align="right" valign="top"><a id="a411d029edda10ba1cd8f232990d261e9"></a>
<a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a411d029edda10ba1cd8f232990d261e9">regular_table_</a> {}</td></tr>
<tr class="memdesc:a411d029edda10ba1cd8f232990d261e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">通常テーブル <br /></td></tr>
<tr class="separator:a411d029edda10ba1cd8f232990d261e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa384f1163c18ffaca170180346410460"><td class="memItemLeft" align="right" valign="top"><a id="aa384f1163c18ffaca170180346410460"></a>
<a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#aa384f1163c18ffaca170180346410460">repetition_table_</a> {}</td></tr>
<tr class="memdesc:aa384f1163c18ffaca170180346410460"><td class="mdescLeft">&#160;</td><td class="mdescRight">千日手テーブル <br /></td></tr>
<tr class="separator:aa384f1163c18ffaca170180346410460"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><h3>template&lt;typename Query, typename RegularTable, typename RepetitionTable&gt;<br />
class komori::tt::detail::TranspositionTableImpl&lt; Query, RegularTable, RepetitionTable &gt;</h3>

<p>詰将棋エンジンの置換表本体 </p>
<dl class="tparams"><dt>Template Parameters</dt><dd>
  <table class="tparams">
    <tr><td class="paramname"><a class="el" href="classkomori_1_1tt_1_1_query.html" title="連続する複数エントリを束ねてまとめて読み書きするためのクラス。">Query</a></td><td>クエリクラス。単体テストしやすいように、外部から注入できるようにテンプレートパラメータにする。 </td></tr>
    <tr><td class="paramname"><a class="el" href="classkomori_1_1tt_1_1_regular_table.html" title="経路に依存しない探索結果を記録する置換表。（通常テーブル）">RegularTable</a></td><td>通常テーブル。単体テストしやすいように、外部から注入できるようにテンプレートパラメータにする。 </td></tr>
    <tr><td class="paramname"><a class="el" href="classkomori_1_1tt_1_1_repetition_table.html" title="千日手手順を記録する置換表">RepetitionTable</a></td><td>千日手テーブル。 単体テストしやすいように、外部から注入できるようにテンプレートパラメータにする。</td></tr>
  </table>
  </dd>
</dl>
<p>置換表は、大きく分けて通常テーブル（RegularTable）と千日手テーブル（RepetitionTable）に分けられる。 通常テーブルは大部分の探索結果を保存する領域で、探索中局面の pn/dn 値および証明済／反証済局面の 詰み手数を保存する。一方、千日手テーブルはその名の通り千日手局面を覚えておくための専用領域である。通常テーブルは 経路に依存しない探索結果を覚えているのに対し、千日手テーブルは経路依存の値を覚えるという棲み分けである。</p>
<p>置換表に対する値の読み書きは、クエリ（Query）クラスにより実現される。置換表の読み書きに必要な情報は （盤面ハッシュや持ち駒など）探索が進んでも不変な値で構成されているので、クエリを使い回すことで 探索性能を向上させることができる。1回1回のクエリ構築はそれほど重い処理ではないように見えるかもしれないが、 実際には同じエントリに何回も読み書きする必要があるので、有意に高速化できる。</p>
<p>また、置換表読み書きは詰将棋エンジン内で頻繁に呼び出す処理のため、現局面だけでなく1手進めた局面のクエリの 構築することができる。（<code>CreateChildQuery()</code>）</p>
<p>このクラスでは、Query, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html" title="経路に依存しない探索結果を記録する置換表。（通常テーブル）">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html" title="千日手手順を記録する置換表">RepetitionTable</a> をテンプレートパラメータ化している。これは、単体テスト時に 外部から注入するためのトリックである。本物のクラスは外部から状態を観測しづらく、Look Up してみなければ 内部変数がどうなっているかが把握できない。単体テストで知りたいのは参照クラスのメンバ関数が正しく呼ばれているかどうか なので、別物に差し替えて中身をチェックできるようにしている。 </p>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00048">48</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a2a0f0621bb26449fdf6d8c00a8600d7e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0f0621bb26449fdf6d8c00a8600d7e">&#9670;&nbsp;</a></span>BuildChildQuery()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a> <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::BuildChildQuery </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkomori_1_1_node.html">Node</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Move&#160;</td>
          <td class="paramname"><em>move</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>局面 <code>n</code> を <code>move</code> で 1 手進めたエントリを読み書きするためのクエリを返す </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>現局面 </td></tr>
    <tr><td class="paramname">move</td><td>次の手 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>クエリ</dd></dl>
<p><code><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#a96c4e38870490176e0053914a17c908c" title="局面 n のエントリを読み書きするためのクエリを返す">BuildQuery()</a></code> と比較して、<code>n.DoMove()</code> により局面を動かさなくてもクエリを構築できるため高速に動作する。 </p>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00129">129</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a2a0f0621bb26449fdf6d8c00a8600d7e_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a2a0f0621bb26449fdf6d8c00a8600d7e_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a2a0f0621bb26449fdf6d8c00a8600d7e_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a2a0f0621bb26449fdf6d8c00a8600d7e_cgraph">
<area shape="rect" title="局面 n を move で 1 手進めたエントリを読み書きするためのクエリを返す" alt="" coords="5,193,184,249"/>
<area shape="rect" href="classkomori_1_1_node.html#a19fbde5adf6e542e61f6c620df5b4d16" title="現在の探索深さ" alt="" coords="243,107,421,133"/>
<area shape="rect" href="classkomori_1_1_node.html#ac82d1552c36647cc88e62b104b77595d" title="move 後の攻め方の持ち駒" alt="" coords="233,157,431,184"/>
<area shape="rect" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de" title="このクラスが保持する Position への参照" alt="" coords="920,132,1060,159"/>
<area shape="rect" href="classkomori_1_1_node.html#a6dfeb2e63ce33d5b9043010cbb8428c3" title="move 後の経路ハッシュ値" alt="" coords="232,259,432,285"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#aa6ac86c8e1152cbe7a18e8d81a55fcef" title="board_key に対応する循環領域へのポインタを取得する" alt="" coords="243,310,421,351"/>
<area shape="rect" href="namespacekomori.html#ae5838f0a6fe258eb2bc0197498cd7358" title="move 後の手駒を返す" alt="" coords="499,5,639,32"/>
<area shape="rect" href="classkomori_1_1_node.html#a4340f73789f45570ffe593fc9d0aafa9" title="現在 OR node かどうか" alt="" coords="480,56,657,83"/>
<area shape="rect" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b" title="現在の攻め方の持ち駒" alt="" coords="705,157,872,184"/>
<area shape="rect" href="classkomori_1_1_node.html#acd0ed0838fa087e459aadae9cf563b0c" title="現在の手番" alt="" coords="721,56,856,83"/>
<area shape="rect" href="namespacekomori.html#ae0ab7ef1101897b620e05208fc8975ee" title="現在の path_key と手 move から1手後の path_key を計算する。" alt="" coords="489,259,648,285"/>
</map>
</div>

</div>
</div>
<a id="a96c4e38870490176e0053914a17c908c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96c4e38870490176e0053914a17c908c">&#9670;&nbsp;</a></span>BuildQuery()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a> <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::BuildQuery </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classkomori_1_1_node.html">Node</a> &amp;&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>局面 <code>n</code> のエントリを読み書きするためのクエリを返す </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>現局面 </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>クエリ </dd></dl>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00111">111</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a96c4e38870490176e0053914a17c908c_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a96c4e38870490176e0053914a17c908c_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a96c4e38870490176e0053914a17c908c_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a96c4e38870490176e0053914a17c908c_cgraph">
<area shape="rect" title="局面 n のエントリを読み書きするためのクエリを返す" alt="" coords="5,92,184,148"/>
<area shape="rect" href="classkomori_1_1_node.html#a19fbde5adf6e542e61f6c620df5b4d16" title="現在の探索深さ" alt="" coords="239,5,417,32"/>
<area shape="rect" href="classkomori_1_1_node.html#a4181d9d06d60b7f11701b8add6a2e69f" title="現在の経路ハッシュ値" alt="" coords="232,56,424,83"/>
<area shape="rect" href="classkomori_1_1_node.html#a2c10b9d22f4966f51b47495088f4fd4b" title="現在の攻め方の持ち駒" alt="" coords="245,107,411,133"/>
<area shape="rect" href="classkomori_1_1_node.html#a485678f91b4653d87fcf5ee6071351de" title="このクラスが保持する Position への参照" alt="" coords="472,132,612,159"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#aa6ac86c8e1152cbe7a18e8d81a55fcef" title="board_key に対応する循環領域へのポインタを取得する" alt="" coords="239,209,417,250"/>
</map>
</div>

</div>
</div>
<a id="ad0d9e65f7b1603b063cd8d3c7252a797"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0d9e65f7b1603b063cd8d3c7252a797">&#9670;&nbsp;</a></span>BuildQueryByKey()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a> <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::BuildQueryByKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structkomori_1_1_board_key_hand_pair.html">BoardKeyHandPair</a>&#160;</td>
          <td class="paramname"><em>key_hand_pair</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Key&#160;</td>
          <td class="paramname"><em>path_key</em> = <code><a class="el" href="namespacekomori.html#a69ee19c9520e168d882df693b6566a9b">kNullKey</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>生のハッシュ値からクエリを構築する </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">key_hand_pair</td><td>盤面ハッシュ値と持ち駒のペア </td></tr>
    <tr><td class="paramname">path_key</td><td>経路ハッシュ値（default: kNullKey） </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>クエリ </dd></dl>
<dl class="section note"><dt>Note</dt><dd>二重カウント検出用 </dd></dl>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00146">146</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_ad0d9e65f7b1603b063cd8d3c7252a797_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_ad0d9e65f7b1603b063cd8d3c7252a797_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_ad0d9e65f7b1603b063cd8d3c7252a797_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_ad0d9e65f7b1603b063cd8d3c7252a797_cgraph">
<area shape="rect" title="生のハッシュ値からクエリを構築する" alt="" coords="5,5,184,61"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#aa6ac86c8e1152cbe7a18e8d81a55fcef" title="board_key に対応する循環領域へのポインタを取得する" alt="" coords="232,13,409,54"/>
</map>
</div>

</div>
</div>
<a id="a153f8d7584e9c0cb08d8d3f6cf011cb3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a153f8d7584e9c0cb08d8d3f6cf011cb3">&#9670;&nbsp;</a></span>Capacity()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::uint64_t <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::Capacity </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>置換表に保存可能な要素数の概算値を取得する。 </p>
<dl class="section return"><dt>Returns</dt><dd>置換表に保存可能な要素数（概算値） </dd></dl>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00200">200</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a153f8d7584e9c0cb08d8d3f6cf011cb3_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a153f8d7584e9c0cb08d8d3f6cf011cb3_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a153f8d7584e9c0cb08d8d3f6cf011cb3_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a153f8d7584e9c0cb08d8d3f6cf011cb3_cgraph">
<area shape="rect" title="置換表に保存可能な要素数の概算値を取得する。" alt="" coords="5,5,184,61"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#a95d62200a1d7e2346e4b2678eeec31e7" title="通常テーブルに保存可能な要素数。" alt="" coords="232,13,409,54"/>
</map>
</div>

</div>
</div>
<a id="a03fe64f10c6759a3d546410a9a5dd97c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03fe64f10c6759a3d546410a9a5dd97c">&#9670;&nbsp;</a></span>CollectGarbage()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::CollectGarbage </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>gc_removal_ratio</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>ガベージコレクションを実行する </p>
<dl class="section return"><dt>Returns</dt><dd>削除されたエントリ数</dd></dl>
<p>通常テーブルおよび千日手テーブルのうち、必要なさそうなエントリの削除を行う。 </p>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00177">177</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a03fe64f10c6759a3d546410a9a5dd97c_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a03fe64f10c6759a3d546410a9a5dd97c_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a03fe64f10c6759a3d546410a9a5dd97c_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a03fe64f10c6759a3d546410a9a5dd97c_cgraph">
<area shape="rect" title="ガベージコレクションを実行する" alt="" coords="5,5,184,61"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#abc27e107c2b787df207bc94082d05e3e" title="通常テーブルの中で、メモリ使用率が高いエントリを間引く" alt="" coords="232,13,409,54"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#afa4c0e9340b321a94d0f21f42fd0ecbb" title="エントリをできるだけ手前の方に移動させる（コンパクション）" alt="" coords="457,13,635,54"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#aa6ac86c8e1152cbe7a18e8d81a55fcef" title="board_key に対応する循環領域へのポインタを取得する" alt="" coords="683,13,860,54"/>
</map>
</div>

</div>
</div>
<a id="a4179ad57f2d4a73ece89f9c380a7751a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4179ad57f2d4a73ece89f9c380a7751a">&#9670;&nbsp;</a></span>Hashfull()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::int32_t <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::Hashfull </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>置換表使用率（千分率）を計算する </p>
<dl class="section return"><dt>Returns</dt><dd>置換表使用率（千分率）</dd></dl>
<p>置換表全体のメモリ使用率を計算する。置換表は通常テーブルと千日手テーブルに分かれているため、それぞれの メモリ使用率を重み付けして足し合わせることで全体のメモリ使用量を見積もる。</p>
<p>通常テーブルのメモリ使用率を計算する際、置換表のサンプリングを行う。そのため、結果の計算にはそこそこの 計算コストがかかる。1秒に1回程度なら問題ないが、それ以上の頻度で呼び出すと性能劣化につながるので注意すること。 </p>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00163">163</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a4179ad57f2d4a73ece89f9c380a7751a_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a4179ad57f2d4a73ece89f9c380a7751a_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a4179ad57f2d4a73ece89f9c380a7751a_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a4179ad57f2d4a73ece89f9c380a7751a_cgraph">
<area shape="rect" title="置換表使用率（千分率）を計算する" alt="" coords="5,31,184,87"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#a9d2dd0f37b92f3af3f34b3b412a5c8a8" title="通常テーブルのメモリ使用率を見積もる。" alt="" coords="241,5,418,47"/>
<area shape="rect" href="classkomori_1_1tt_1_1_repetition_table.html#a164c681a2c3ac0b306e8807d2d6014cd" title="置換表のメモリ使用率を求める。" alt="" coords="232,71,427,112"/>
<area shape="rect" href="classkomori_1_1tt_1_1_repetition_table.html#af6cd61f2f2b434ec7528b7a844a5179b" title="現在置換表に保存されている経路ハッシュ値の個数をカウントする。" alt="" coords="475,71,669,112"/>
</map>
</div>

</div>
</div>
<a id="a38165a8d6b382f5b9454f51c717c90cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38165a8d6b382f5b9454f51c717c90cd">&#9670;&nbsp;</a></span>Load()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::istream&amp; <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::Load </td>
          <td>(</td>
          <td class="paramtype">std::istream &amp;&#160;</td>
          <td class="paramname"><em>is</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>バイナリ入力ストリーム <code>in</code> から置換表エントリを読み込む。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">is</td><td>バイナリ入力ストリーム </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>is</code> </dd></dl>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00194">194</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a38165a8d6b382f5b9454f51c717c90cd_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a38165a8d6b382f5b9454f51c717c90cd_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a38165a8d6b382f5b9454f51c717c90cd_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a38165a8d6b382f5b9454f51c717c90cd_cgraph">
<area shape="rect" title="バイナリ入力ストリーム in から置換表エントリを読み込む。" alt="" coords="5,39,224,80"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#a58fb5620ad6be47be76f6b33626ba643" title="バイナリ入力ストリーム in から置換表エントリを読み込む。" alt="" coords="272,39,449,80"/>
<area shape="rect" href="classkomori_1_1tt_1_1_entry.html#a5430ffd685eb1bc77cf93af169bfa37f" title="盤面ハッシュ値（コンパクション用）" alt="" coords="519,5,653,47"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#aa6ac86c8e1152cbe7a18e8d81a55fcef" title="board_key に対応する循環領域へのポインタを取得する" alt="" coords="497,71,675,112"/>
</map>
</div>

</div>
</div>
<a id="a60ba9bb9c00c85a2475c98b256ab1051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ba9bb9c00c85a2475c98b256ab1051">&#9670;&nbsp;</a></span>NewSearch()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::NewSearch </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>新しい探索を始める </p>
<p>探索の開始前に必ず呼び出される。千日手テーブルについては、前回の探索結果を流用するのは難しいのですべて 消してしまう。一方、通常探索エントリは削除にも時間がかかるのでそのまま残しておく。</p>
<p>通常探索エントリを完全に消去したい場合は <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#af55851a911e7918a6b97947855f2f325" title="以前の探索結果をすべて消去する。">Clear()</a> を使うこと。</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html#af55851a911e7918a6b97947855f2f325" title="以前の探索結果をすべて消去する。">Clear</a> </dd></dl>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00096">96</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a60ba9bb9c00c85a2475c98b256ab1051_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a60ba9bb9c00c85a2475c98b256ab1051_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a60ba9bb9c00c85a2475c98b256ab1051_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a60ba9bb9c00c85a2475c98b256ab1051_cgraph">
<area shape="rect" title="新しい探索を始める" alt="" coords="5,5,184,61"/>
<area shape="rect" href="classkomori_1_1tt_1_1_repetition_table.html#a1cf06ccf4ee8c44a6f965ec43f21185a" title="置換表に保存された経路ハッシュ値をすべて削除する。" alt="" coords="232,13,427,54"/>
</map>
</div>

</div>
</div>
<a id="a315463f0ac29c325849d661a15cdc167"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a315463f0ac29c325849d661a15cdc167">&#9670;&nbsp;</a></span>Resize()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::Resize </td>
          <td>(</td>
          <td class="paramtype">std::uint64_t&#160;</td>
          <td class="paramname"><em>hash_size_mb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>置換表サイズを <code>hash_size_mb</code> に変更し、書かれていた内容をすべて消去する。 </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">hash_size_mb</td><td>新しい置換表サイズ（MB） </td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><code>hash_size_mb &gt;= 1</code></dd></dl>
<p>置換表サイズが <code>hash_size_mb</code> 以下になるようにする。置換表は大きく分けて <a class="el" href="classkomori_1_1tt_1_1_regular_table.html" title="経路に依存しない探索結果を記録する置換表。（通常テーブル）">RegularTable</a> と <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html" title="千日手手順を記録する置換表">RepetitionTable</a> に 分けられるが、それらの合計サイズが <code>hash_size_mb</code>[MB] を超えないようにする。 </p>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00071">71</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a315463f0ac29c325849d661a15cdc167_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a315463f0ac29c325849d661a15cdc167_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a315463f0ac29c325849d661a15cdc167_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a315463f0ac29c325849d661a15cdc167_cgraph">
<area shape="rect" title="置換表サイズを hash_size_mb に変更し、書かれていた内容をすべて消去する。" alt="" coords="5,31,184,87"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#a25ac332dc05bf44ac45e1e3aecd0a0c7" title="要素数が num_entries 個になるようにメモリの確保・解放を行う" alt="" coords="241,5,418,47"/>
<area shape="rect" href="classkomori_1_1tt_1_1_repetition_table.html#a7c4e6740cfab83ffb119e184b2b286ed" title="置換表に登録できる key の最大個数を設定する。" alt="" coords="232,71,427,112"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#a0fb34e7a1f84b14f29e014f9bb8b41f6" title="以前の探索結果をすべて消去する。" alt="" coords="483,5,661,47"/>
<area shape="rect" href="classkomori_1_1tt_1_1_repetition_table.html#a1cf06ccf4ee8c44a6f965ec43f21185a" title="置換表に保存された経路ハッシュ値をすべて削除する。" alt="" coords="475,71,669,112"/>
</map>
</div>

</div>
</div>
<a id="a1e58a8adc4d1f758e77aa32caa4b34ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e58a8adc4d1f758e77aa32caa4b34ba">&#9670;&nbsp;</a></span>Save()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename Query , typename RegularTable , typename RepetitionTable &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream&amp; <a class="el" href="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl.html">komori::tt::detail::TranspositionTableImpl</a>&lt; <a class="el" href="classkomori_1_1tt_1_1_query.html">Query</a>, <a class="el" href="classkomori_1_1tt_1_1_regular_table.html">RegularTable</a>, <a class="el" href="classkomori_1_1tt_1_1_repetition_table.html">RepetitionTable</a> &gt;::Save </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>置換表の中身をバイナリ出力ストリーム <code>os</code> へ出力する </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">os</td><td>バイナリ出力ストリーム </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>os</code></dd></dl>
<p>千日手テーブルについては書き出しを行わない。なぜなら、探索開始局面が同一でなければ再利用しづらい情報であり、 多くの詰将棋では千日手テーブルなしでもそれほど時間がかからず詰み手順を復元できるためである。 </p>

<p class="definition">Definition at line <a class="el" href="transposition__table_8hpp_source.html#l00187">187</a> of file <a class="el" href="transposition__table_8hpp_source.html">transposition_table.hpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classkomori_1_1tt_1_1detail_1_1_transposition_table_impl_a1e58a8adc4d1f758e77aa32caa4b34ba_cgraph.png" border="0" usemap="#aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a1e58a8adc4d1f758e77aa32caa4b34ba_cgraph" alt=""/></div>
<map name="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a1e58a8adc4d1f758e77aa32caa4b34ba_cgraph" id="aclasskomori_1_1tt_1_1detail_1_1_transposition_table_impl_a1e58a8adc4d1f758e77aa32caa4b34ba_cgraph">
<area shape="rect" title="置換表の中身をバイナリ出力ストリーム os へ出力する" alt="" coords="5,5,224,47"/>
<area shape="rect" href="classkomori_1_1tt_1_1_regular_table.html#ad675f3ae1432dd82b49b1a39b7286766" title="置換表の中身をバイナリ出力ストリーム os へ出力する" alt="" coords="272,5,449,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
